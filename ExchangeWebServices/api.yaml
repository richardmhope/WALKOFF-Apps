walkoff: '0.1'
info:
  version: 1.0.0
  title: Exchange Web Services
  description: Interact with MS Exchange
  contact:
    name: https://github.com/richardmhope
  license:
    name: Creative Commons
actions:
  read_message:
    run: app.ExchangeWebServices.read_message
    description: Gets email with given item_id
    parameters:
        - name: item_id
          description: The item_id of the email to read
          required: true
          schema:
            type: string
    returns:
      Success:
        schema:
          type: object
  move_message:
    run: app.ExchangeWebServices.move_message
    description: Moves email to folder under inbox
    parameters:
        - name: item_id
          description: The item_id of the email to read
          required: true
          schema:
            type: string
        - name: folder
          description: The destination folder
          required: true
          schema:
            type: string
    returns:
      Success:
        schema:
          type: object
  delete_message:
    run: app.ExchangeWebServices.delete_message
    description: Moves email with given item_id to Deleted Items
    parameters:
        - name: item_id
          description: The item_id of the email to delete
          required: true
          schema:
            type: string
    returns:
      Success:
        schema:
          type: string
  hard_delete_message:
    run: app.ExchangeWebServices.hard_delete_message
    description: Deletes email with given item_id
    parameters:
        - name: item_id
          description: The item_id of the email to delete
          required: true
          schema:
            type: string
    returns:
      Success:
        schema:
          type: string
  categorize_message:
    run: app.ExchangeWebServices.categorize_message
    description: Categorizes email with given item_id
    parameters:
        - name: item_id
          description: The item_id of the email to delete
          required: true
          schema:
            type: string
        - name: categories
          description: List of categories to set
          required: true
          schema:
            type: array
    returns:
      Success:
        schema:
          type: string
  get_attachment_count:
    run: app.ExchangeWebServices.get_attachment_count
    description: Attachment count email with given item_id
    parameters:
        - name: item_id
          description: The item_id of the email to delete
          required: true
          schema:
            type: string
            returns:
      Success:
        schema:
          type: integer
  attachment_is_message:
    run: app.ExchangeWebServices.attachment_is_message
    description: Gets attachment type for email with given item_id
    parameters:
        - name: item_id
          description: The item_id of the email to delete
          required: true
          schema:
            type: string
            returns:
      Success:
        schema:
          type: boolean
  get_message_attachment:
    run: app.ExchangeWebServices.get_message_attachment
    description: Gets attached email with given item_id
    parameters:
        - name: item_id
          description: The item_id of the email to delete
          required: true
          schema:
            type: string
    returns:
      Success:
        schema:
          type: object
  get_message_attachments:
    run: app.ExchangeWebServices.get_message_attachments
    description: Gets the content of a message attachment
    parameters:
        - name: item_id
          description: The item_id of the email to get the attachments for
          required: true
          schema:
            type: string
    returns:
      Success:
        schema:
          type: string
  get_inbox_folders:
    run: app.ExchangeWebServices.get_inbox_folders
    description: Gets a list of folders in the inbox
    returns:
      Success:
        schema:
          type: array
  get_inbox_messages:
    run: app.ExchangeWebServices.get_inbox_messages
    description: Gets a list of messages in the inbox
    returns:
      Success:
        schema:
          type: array
  get_oldest_inbox_message:
    run: app.ExchangeWebServices.get_oldest_inbox_message
    description: Gets the item_id oldest message in the inbox
    returns:
      Success:
        schema:
          type: string
  get_newest_inbox_message:
    run: app.ExchangeWebServices.get_newest_inbox_message
    description: Gets the item_id newest message in the inbox
    returns:
      Success:
        schema:
          type: string
devices:
  Exchange:
    description: Exchange Web Services Instance
    fields:
      - name: username
        type: string
        description: Username for Exchange
        placeholder: username
        required: true
      - name: password
        type: string
        description: Password for Exchange
        encrypted: true
        placeholder: password
        required: true
      - name: inbox
        description: Inbox to Connect to
        type: string
        placeholder: Inbox
        required: true
      - name: host
        description: Hostname/IP address of Exchange
        type: string
        placeholder: Host
        required: true